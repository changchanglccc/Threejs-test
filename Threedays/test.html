<!DOCTYPE html>
<html>
	<head>
		<meta charset=utf-8>
		<title>My first three.js app</title>
		<style>
			body { margin: 0; }
			canvas { width: 100%; height: 100% }
		</style>
	</head>
	<body>
		<script src="js/three.js"></script>
		<script src="js/OBJLoader.js"></script>
		<!--<script type="text/javascript" src="js/TrackballControls.js"></script>-->
		<!--<script src="js/BufferGeometryLoader.js"></script>-->
		<script>
            var camera, scene, renderer;
            var container, stats;
            var controls;

            init();
            render();
            // animate();

			function init(){
                container = document.createElement('div');
                document.body.appendChild(container);

				camera = new THREE.PerspectiveCamera(70, window.innerWidth / window.innerHeight, 1, 2000);
				camera.position.set(0,10,20);

                // controls = new THREE.TrackballControls( camera );

                //scene
                scene = new THREE.Scene();

                // renderer
                renderer = new THREE.WebGLRenderer();
                renderer.setPixelRatio( window.devicePixelRatio);
                renderer.setSize( window.innerWidth, window.innerHeight);
                container.appendChild(renderer.domElement);
                // document.body.appendChild( renderer.domElement );

				// plane for the ground
                var planeGeometry = new THREE.PlaneBufferGeometry( window.innerWidth,window.innerHeight);
                var planeMaterial = new THREE.MeshBasicMaterial( {color: 0x123456});	//plane color
                var plane = new THREE.Mesh( planeGeometry, planeMaterial);
                plane.position.set(0,-8,-10);
                scene.add(plane);

                // ambient light
                var ambient = new THREE.AmbientLight( 0x444444);
                scene.add( ambient);

                // directional light
                var directionalLight = new THREE.DirectionalLight( 0xffeedd );
                directionalLight.position.set( 0, 0, 1 ).normalize();
                scene.add( directionalLight );

                // .obj file
                console.log('---------1. before loader -------------');
                var loader1 = new THREE.OBJLoader();
                loader1.load(
                    //obj file
                    'models/obj/map.obj',
                    function(object){
                        object.scale.set(0.0005,0.0005,0.0005);
                        scene.add(object);
                    },
                    // function(geometry){
                    //     var materal = new THREE.MeshBasicMaterial({
                    //         color: 0x777777
                    //     });
                    // },


                    // called when loading is in progresses
                    function ( xhr ) {

                        console.log( ( xhr.loaded / xhr.total * 100 ) + '% loaded' );

                    },
                    // called when loading has errors
                    function ( error ) {

                        console.log( 'An error happened' );

                    }
                );
                console.log('--------- 1.after loader -------------')

                // console.log('--------- 2.before loader -------------');
                // // object loader: json object
                // var loader = THREE.BufferGeometryLoader(); //new THREE.JSONLoader();
                // loader.load(
                //     'models/json/data.json',
                //     // onLoad callback
                //     function ( geometry ) {
                //         var material = new THREE.MeshLambertMaterial( { color: 0xF5F5F5 } );
                //         var object = new THREE.Mesh( geometry, material );
                //         scene.add( object );
                //     },
                //
                //     // function ( obj ) {
                //     //     // Add the loaded object to the scene
                //     //     obj.scale.set(0.01,0.01,0.01);
                //     //     scene.add( obj );
                //     // },
                //
                //     // onProgress callback
                //     function ( xhr ) {
                //         console.log( (xhr.loaded / xhr.total * 100) + '% loaded' );
                //     },
                //
                //     // onError callback
                //     function ( err ) {
                //         console.error( 'An error happened' );
                //     }
                // );
                // console.log('---------2. after loader -------------');

                // camera look at 
                camera.lookAt(plane.position);

                // stats = new Stats();
                // container.appendChild( stats.dom );

                // window.addEventListener( 'resize', onWindowResize, false );

            }

            // function onWindowResize(){
             //    camera.aspect = window.innerWidth / window.innerHeight;
             //    camera.updateProjectionMatrix();
            //
             //    renderer.setSize( window.innerWidth, window.innerHeight );
			// }

            function render(){
                requestAnimationFrame(render);
                renderer.render(scene, camera);
            }

		</script>
	</body>
</html>